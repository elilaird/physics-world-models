defaults:
  - env: oscillator_visual
  - dataset: oscillator_visual_testing
  - model: visual_world_model
  - predictor: spatial_jump
  - _self_

seed: 42

# Path to a pretrained checkpoint to load weights from (null = train from scratch)
# pretrained_checkpoint: /lustre/smuexa01/client/users/ejlaird/physics-world-models/outputs/2026-02-11/16-29-59/visual_world_model/best_model.pt

# pos/mom split: decoder only uses pos latent (latentdim=16 and channel concat)
pretrained_checkpoint: /lustre/smuexa01/client/users/ejlaird/physics-world-models/outputs/2026-02-12/15-17-31/visual_world_model/best_model.pt

# latent 16 split but no channel concat
#/lustre/smuexa01/client/users/ejlaird/physics-world-models/outputs/2026-02-12/13-53-34/visual_world_model/best_model.pt

training:
  epochs: 100
  batch_size: 32
  # Single optimizer learning rate (used in HGN mode)
  lr: 1.5e-4
  # Separate optimizer learning rates (used in detached mode)
  encoder_lr: 1e-4
  decoder_lr: 1e-5
  predictor_lr: 1e-3
  train_split: 0.8
  # Which visual model components to train (false = frozen).
  # Only applies when model.type == "visual".
  train_encoder: false
  train_decoder: true
  train_predictor: true
  # End-to-end training: predictor loss in pixel space, gradients flow into encoder.
  # false = detached (latent-space predictor loss, compatible with JEPA etc.)
  end_to_end: false
  # Training mode for train_visual.py: "hgn" (encode init → rollout → decode all)
  # or "detached" (per-frame encoding with detached predictor loss)
  training_mode: hgn

ckpt_base_path: '/lustre/smuexa01/client/users/ejlaird/physics-world-models'
data_root: ${ckpt_base_path}/datasets

hydra:
  run:
    dir: ${ckpt_base_path}/outputs/${now:%Y-%m-%d}/${now:%H-%M-%S}/${model.name}
  sweep:
    dir: ${ckpt_base_path}/multirun/${now:%Y-%m-%d}/${now:%H-%M-%S}
    subdir: ${model.name}

wandb:
  enabled: true
  project: physics-world-models
  log_images_every: 1
  n_log_images: 1

checkpoint_dir: ${ckpt_base_path}/outputs/${now:%Y-%m-%d}/${now:%H-%M-%S}/${model.name}

# evaluate.py settings
checkpoint: null

eval:
  horizon: 50
  dt_values: [0.05, 0.1, 0.2, 0.5]
  n_rollouts: 8
  # Sequence length (actions) for dt generalization trajectories.
  # null = use data.seq_len from the dataset config.
  dt_seq_len: null

# report.py settings
checkpoints: []
report_checkpoint_dir: null

report:
  output_dir: ${ckpt_base_path}/reports/${now:%Y-%m-%d_%H-%M-%S}


